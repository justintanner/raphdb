<% content_for(:head) do %>
  <style>
    .main-card {
      min-width: <%= @image.width(:large) %>px;
      width: <%= @image.width(:large) %>px;
    }

    @media (max-width: <%= @image.width(:large) %>px) {
      .main-card {
        width: 100%;
        min-width: 100%;
      }
    }

    .sidebar {
      width: <%= @image.width(:large) %>px;
      max-width: 100%;
    }

    @media (min-width: <%= @image.width(:large) + 450 %>px) {
      .sidebar {
        width: 350px;
      }
    }
  </style>
<% end %>

<div class="container">
  <h1 class="text-center mt-1 pb-3"><%= @item.title %></h1>
</div>

<div class="container-fluid">
  <div class="row justify-content-center g-3">
    <div class="col-auto">
      <div class="card main-card">
        <%= image_tag @image.variant(:large).processed.url,
                      srcset: @image.srcset(:large_retina, :large, :medium_retina, :medium),
                      sizes: "100vw",
                      width: @image.width(:large),
                      height: @image.height(:large),
                      class: "card-img-top img-fluid" %>
        <div class="card-body p-1">
          <%= render "splide", { item: @item,
                                 current_image: @image,
                                 max_width: @image.width(:large),
                                 position: params[:picture_number] || 1 } %>
        </div>
      </div>
    </div>

    <div class="col-auto">
      <div class="sidebar">
        <div class="card mb-3">
          <div class="card-header px-3 border-bottom-0">
            <div class="row">
              <div class="col">
                <a href="javascript:void(0);" class="d-flex align-items-center">
                  <%= render "svgs/bi-arrows-fullscreen" %>
                  <span class="ms-2"><small>Expand Images</small></span>
                </a>
              </div>
              <div class="col">
                <a href="javascript:void(0);"
                   id="copy-link"
                   class="d-flex align-items-center justify-content-end"
                   data-clipboard-text="<%= request.original_url %>"
                   data-bs-original-title="Copy to Clipboard"
                   data-controller="clipboard">
                  <%= render "svgs/bi-link-45deg" %>
                  <span class="ms-1"><small>Share Link</small></span>
                </a>
              </div>
            </div>
          </div>
        </div>


        <div class="card mb-3">
          <div class="card-header px-3">
            <div class="row">
              <div class="col">Card</div>
              <div class="col text-end">
                <a class="pe-1 align-middle" href=""><%= render "svgs/bi-arrow-left-square" %></a>
                <span class="font-monospace align-middle"><small>1/13</small></span>
                <a class="ps-1 align-middle" href=""><%= render "svgs/bi-arrow-right-square" %></a>
              </div>
            </div>
          </div>
          <div class="card-body">
            <% @item.populated_fields.each do |field| %>
              <% if @item.short?(field) %>
                <p class="mb-2"><label class="text-muted me-1"><small><%= field.title %></small></label><%= @item.data[field.key] %></p>
              <% else %>
                <label class="text-muted"><small><%= field.title %></small></label>
                <p><%= @item.data[field.key] %></p>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
